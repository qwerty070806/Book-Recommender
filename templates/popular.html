{% extends "layout.html" %}
{% block content %}

    {# This is the new logic #}
    {% if 'user_id' in session %}
        <h2>Welcome, User {{ session['user_id'] }}!</h2>
        <p>You don't have a rating history yet. Get started by rating some of our popular books below!</p>
    {% else %}
        <h2>Welcome!</h2>
        <p>Log in or register to get personalized recommendations. In the meantime, here are some of our most popular books:</p>
    {% endif %}

    <hr>
    <h3>Popular Books</h3>

    <div class="swiper">
        <div class="swiper-wrapper">
            {% for book in books %}
            <div class="swiper-slide">
                <img src="{{ book['Image-URL-M'] }}" alt="{{ book['Book-Title'] }}">
                <div class="card-content">
                    <strong>{{ book['Book-Title'] }}</strong>
                    <p>by {{ book['Book-Author'] }}</p>
                    <a href="{{ url_for('book_page', book_title=book['Book-Title']) }}" class="show-more-btn">Show More</a>
                    <button class="btn btn-green rate-this-btn" data-title="{{ book['Book-Title'] }}">I've Read This</button>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="swiper-pagination"></div>

        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>

{% endblock %}